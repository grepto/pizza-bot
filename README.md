# Чат-бот пицерии
Покупатель может посмотреть меню, добавить понравивщиеся в пицы оформить и оплатить заказ, оформить доставку.
Бот умеет принимать и обрабатывать гелогокацию для расчета стоимости доставки.

Демо бот - [@mega_fish_bot](https://t.me/mega_fish_bot)

Для работы бота нужно зарегистрироваться в системе [moltin](https://moltin.com)

### Как установить
Для работы скрипта нужно зарегистрировать в операционной системе переменные окружения

- `TELEGRAM_TOKEN` - Токен бота в телеграме
- `TELEGRAM_PAYMENT_TOKEN` - Токен платежной системы для приема платежей
- `TELEGRAM_PAYMENT_PARAMETER` - Значение параметра


- `REDIS_HOST` - адрес инстанса в сервисе redislabs.com
- `REDIS_PORT` - порт
- `REDIS_PASWORD` - пароль от базы

- `MOLTIN_CLIENT_ID`=идентификатор клиента в системе Moltin
- `MOLTIN_SECRET`=секретный ключ в системе Moltin


- `LOG_LEVEL` - уровень логирования (NOTSET, DEBUG, INFO, WARNING, ERROR, CRITICAL). Подробно о каждом уровне

Если телеграм-бот не запускается из-за блокировок, нужно добавить еще одну переменную окружения


- `TELEGRAM_PROXY` - урл прокси сервера через который должен работать телеграм-бот. Рабочий прокси можно взять [на этом сайте](http://spys.one/proxies/)

 
Python3 должен быть уже установлен.
Затем используйте `pip` (или `pip3`, есть есть конфликт с Python2) для установки зависимостей:
```
pip install -r requirements.txt
```

### Как использовать
Для запуска бота нужно запустить `main.py`

Пример использования
```sh
python main.py 
```

### Деплой и запуск на Heroku
Бота можно запустить на [Heroku](https://.heroku.com). Нужно создать на Heroku новое приложение, связать его с
репозиторием, задеплоить и сбилдить исходники.

В настройках приложения на heroku (вкладка Settings) нужно добавить в Config Vars переменные окружения и их значения
описанные в разделе Как установить. Чтобы не забивать логи инстанса на heroku, `LOG_LEVEL` лучше выставить значение
`INFO`

После настройки приложение нужно запустить во вкладке `Resource`. 


Для управления ботом на Heroku из коммандной строки нужно установить
[heroku cli](https://devcenter.heroku.com/categories/command-line) и авторизоваться из терминала в Heroku

Для проверки статуса приложения из терминала нужно выполнить команду
```sh
heroku ps -a название_приложения_на_heroku
```

### Цель проекта
Код написан в образовательных целях на онлайн-курсе для веб-разработчиков dvmn.org.